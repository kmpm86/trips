<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vegas Escape 2026 Comparison & AI Assistant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* CORE DESIGN PRINCIPLES */
        :root {
            --primary-purple: #300A24;   /* Deep Eggplant - Partner's Favorite */
            --forest-green: #1B3022;     /* Deep Forest Green - Your Favorite */
            --accent-purple: #632B5C;    /* Rich Plum */
            --accent-green: #2D5A42;     /* Vibrant Forest */
            --light-lavender: #EADAF2;   /* Soft Highlight */
            --gold: #C5A059;             /* Luxury Gold */
            --white: #FFFFFF;
            --text-dark: #2D2D2D;
            --text-light: #F5F5F0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #f1f1f1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 50px;
            padding: 50px 0;
            font-family: 'Lato', sans-serif;
            scroll-behavior: smooth;
        }

        .slide-container {
            width: 1280px;
            height: 720px;
            background-color: var(--white);
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3);
            border-radius: 4px;
        }

        /* BACKGROUND DESIGN: Purple & Green Gradients */
        .slide-container::before {
            content: '';
            position: absolute;
            top: -200px;
            left: -200px;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(99, 43, 92, 0.15) 0%, rgba(255,255,255,0) 70%);
            z-index: 0;
        }

        .slide-container::after {
            content: '';
            position: absolute;
            bottom: -200px;
            right: -200px;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(27, 48, 34, 0.1) 0%, rgba(255,255,255,0) 70%);
            z-index: 0;
        }

        /* TYPOGRAPHY */
        h1, h2, .slide-title {
            font-family: 'Playfair Display', serif;
            color: var(--primary-purple);
        }

        h1 { font-size: 80px; text-transform: uppercase; letter-spacing: 4px; }
        .slide-title { font-size: 42px; margin-bottom: 30px; font-weight: 700; border-bottom: 3px solid var(--forest-green); display: inline-block; padding-bottom: 10px; width: 100%; text-align: left;}
        h3 { font-size: 24px; color: var(--accent-green); font-family: 'Lato', sans-serif; font-weight: 700; }
        p, li { font-size: 18px; line-height: 1.5; color: var(--text-dark); }
        .subtitle { font-size: 26px; font-style: italic; color: var(--gold); margin-bottom: 20px; }

        .content-area {
            flex-grow: 1;
            padding: 60px 80px;
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        /* LAYOUTS */
        .title-slide {
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--forest-green) 100%);
            color: var(--white);
            text-align: center;
            justify-content: center;
        }
        .title-slide h1 { color: var(--white); text-shadow: 2px 2px 0px rgba(0,0,0,0.2); }
        .title-slide .gold-accent { color: var(--gold); font-weight: 700; }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            height: 100%;
        }

        .comparison-card {
            background-color: var(--white);
            border: 1px solid #EEE;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            position: relative;
        }
        .comparison-card.highlighted { border: 2px solid var(--accent-green); background: #F0F4F2; }
        .comparison-card h3 { margin-bottom: 10px; border-bottom: 1px solid var(--gold); padding-bottom: 5px; font-size: 18px; line-height: 1.1; }
        .comparison-card ul { list-style: none; margin-top: 10px; flex-grow: 1; }
        .comparison-card li { margin-bottom: 8px; font-size: 12px; display: flex; align-items: flex-start; gap: 6px; line-height: 1.3; }
        .comparison-card li i { color: var(--accent-green); margin-top: 2px; }
        .price-tag { font-size: 26px; font-weight: 700; color: var(--forest-green); padding-top: 15px; border-top: 1px solid #DDD; margin-top: 10px; }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            align-items: center;
        }

        /* TABLE */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: var(--forest-green); color: var(--gold); padding: 20px; text-align: left; }
        td { padding: 18px 20px; border-bottom: 1px solid #DDD; }
        tr:nth-child(even) { background-color: #F4F7F5; }

        /* GALLERY LAYOUT */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: 1fr 1fr;
            gap: 15px;
            height: 100%;
        }
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 4px;
            height: 230px;
            background-color: #eee;
        }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; }
        .gallery-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(27, 48, 34, 0.9);
            color: var(--gold);
            padding: 10px;
            font-size: 14px;
            font-weight: 600;
        }

        /* MATH */
        #formula-container { background: #FDFDFD; padding: 25px; border: 1px solid #EEE; border-left: 5px solid var(--accent-green); margin: 20px 0; }
        
        /* IMAGE_RIGHT_TEXT_LEFT */
        .image-wrapper { height: 450px; border-radius: 8px; overflow: hidden; border: 4px solid var(--light-lavender); background-color: #eee; }
        .image-wrapper img { width: 100%; height: 100%; object-fit: cover; }

        .highlight-box {
            background-color: var(--forest-green);
            color: var(--white);
            padding: 30px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .highlight-box p { color: var(--white); font-size: 16px; }

        .benefit-tag {
            background: var(--accent-purple);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            margin-bottom: 5px;
            display: inline-block;
        }

        /* ✨ AI ASSISTANT STYLES ✨ */
        #ai-assistant-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-green));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid var(--gold);
        }

        #ai-assistant-btn:hover {
            transform: scale(1.1);
        }

        #ai-container {
            position: fixed;
            bottom: 110px;
            right: 30px;
            width: 400px;
            max-height: 600px;
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            z-index: 999;
            overflow: hidden;
            border: 1px solid var(--gold);
            font-family: 'Lato', sans-serif;
        }

        .ai-header {
            background: var(--primary-purple);
            color: var(--gold);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .ai-header h4 { margin: 0; font-family: 'Playfair Display', serif; font-size: 20px; }

        .ai-messages {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f9f9f9;
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: 400px;
        }

        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 15px;
            font-size: 14px;
            line-height: 1.4;
        }

        .user-message {
            align-self: flex-end;
            background: var(--forest-green);
            color: white;
            border-bottom-right-radius: 2px;
        }

        .bot-message {
            align-self: flex-start;
            background: var(--light-lavender);
            color: var(--primary-purple);
            border-bottom-left-radius: 2px;
        }

        .ai-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .ai-input-row { display: flex; gap: 10px; }

        #ai-input {
            flex-grow: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            font-family: inherit;
        }

        .ai-btn {
            background: var(--accent-green);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: opacity 0.2s;
        }

        .ai-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .ai-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .suggestion-chip {
            background: #eee;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 11px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .suggestion-chip:hover { background: var(--light-lavender); }

        .loading-dots { display: inline-flex; gap: 4px; }
        .dot { width: 6px; height: 6px; background: #888; border-radius: 50%; animation: bounce 1s infinite; }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }

        /* Markdown-ish formatting for bot responses */
        .bot-message b { color: var(--accent-purple); }
        .bot-message ul { margin-left: 15px; }

    </style>
</head>
<body>

    <!-- Slide 1: Title_Slide -->
    <div class="slide-container title-slide" id="slide1">
        <div class="content-area">
            <h1 style="color: white;">Vegas Selection <span class="gold-accent">2026</span></h1>
            <p class="subtitle" style="color: var(--gold);">February 15th – February 17th</p>
            <div style="height: 2px; width: 200px; background: var(--gold); margin: 30px auto;"></div>
            <p style="font-size: 20px; letter-spacing: 2px; color: rgba(255,255,255,0.8);">CURATED LUXURY & STRATEGIC VALUE</p>
        </div>
    </div>

    <!-- Slide 2: Comparison Grid (Side-by-Side) -->
    <div class="slide-container" id="slide2">
        <div class="content-area">
            <h2 class="slide-title">Side-by-Side Comparison</h2>
            <div class="comparison-grid">
                <!-- Option A -->
                <div class="comparison-card highlighted">
                    <div class="benefit-tag">VIP Sanctuary</div>
                    <h3>Palazzo Prestige</h3>
                    <p style="font-size: 11px; font-weight: 700; color: var(--accent-green);">FHR Booking</p>
                    <ul>
                        <li><i class="fas fa-check"></i> Private 23rd Fl. Check-in</li>
                        <li><i class="fas fa-check"></i> <strong>Guaranteed 4PM Checkout</strong></li>
                        <li><i class="fas fa-check"></i> Open Bar (4 PM–7 PM)</li>
                        <li><i class="fas fa-check"></i> Daily Lounge Breakfast</li>
                        <li><i class="fas fa-plus"></i> $65 FHR Breakfast Credit</li>
                        <li><i class="fas fa-plus"></i> <strong>$100 Property Credit</strong></li>
                        <li><i class="fas fa-check"></i> Sapphire Status Benefits</li>
                    </ul>
                    <div class="price-tag">$1,153</div>
                </div>
                <!-- Option B -->
                <div class="comparison-card">
                    <div class="benefit-tag" style="background: var(--accent-green);">Top Romance</div>
                    <h3>Cosmopolitan</h3>
                    <p style="font-size: 11px; font-weight: 700; color: var(--accent-purple);">FHR Booking</p>
                    <ul>
                        <li><i class="fas fa-check"></i> <strong>Private Fountain Balcony</strong></li>
                        <li><i class="fas fa-check"></i> Guaranteed 4PM Checkout</li>
                        <li><i class="fas fa-check"></i> Center-Strip Location</li>
                        <li><i class="fas fa-check"></i> Daily Breakfast for 2</li>
                        <li><i class="fas fa-check"></i> <strong>$100 Food/Bev Credit</strong></li>
                        <li><i class="fas fa-check"></i> Potential Room Upgrade</li>
                    </ul>
                    <div class="price-tag">$1,215</div>
                </div>
                <!-- Option C -->
                <div class="comparison-card">
                    <div class="benefit-tag">Smart Value</div>
                    <h3>Palazzo Standard</h3>
                    <p style="font-size: 11px; font-weight: 700; color: var(--accent-green);">FHR Booking</p>
                    <ul>
                        <li><i class="fas fa-check"></i> Massive 720 Sq. Ft. Suite</li>
                        <li><i class="fas fa-check"></i> Guaranteed 4PM Checkout</li>
                        <li><i class="fas fa-check"></i> <strong>Bouchon French Brunch</strong></li>
                        <li><i class="fas fa-check"></i> <strong>$100 Property Credit</strong></li>
                        <li><i class="fas fa-check"></i> Noon Check-in Potential</li>
                        <li><i class="fas fa-check"></i> Sapphire Status Benefits</li>
                    </ul>
                    <div class="price-tag">$813</div>
                </div>
                <!-- Option D -->
                <div class="comparison-card">
                    <div class="benefit-tag" style="background: #555;">The Tech Hack</div>
                    <h3>Conrad RW</h3>
                    <p style="font-size: 11px; font-weight: 700; color: #777;">THC Booking</p>
                    <ul>
                        <li><i class="fas fa-check"></i> Brand New Tech-Forward Suite</li>
                        <li><i class="fas fa-check"></i> Premium Strip View Room</li>
                        <li><i class="fas fa-check"></i> <strong>$100 Property Credit</strong></li>
                        <li><i class="fas fa-check"></i> Room Upgrade Potential</li>
                        <li><i class="fas fa-times" style="color:#888;"></i> 11:00 AM Checkout Only</li>
                        <li><i class="fas fa-times" style="color:#888;"></i> No Daily Breakfast Benefit</li>
                    </ul>
                    <div class="price-tag">$577</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 3: Financial Summary Table -->
    <div class="slide-container" id="slide3">
        <div class="content-area">
            <h2 class="slide-title">Total Cash Out-of-Pocket</h2>
            <p class="subtitle">Including Flights, Resort Fees, and Transportation</p>
            <table>
                <thead>
                    <tr>
                        <th>Option Package</th>
                        <th>Hotel (Net)</th>
                        <th>Flight + Uber</th>
                        <th>Net Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Palazzo Prestige (The VIP Sanctuary)</strong></td>
                        <td>$758.38</td>
                        <td>$395.20</td>
                        <td><span style="color: var(--accent-green); font-weight: 700;">$1,153.58</span></td>
                    </tr>
                    <tr>
                        <td><strong>The Cosmopolitan (The Fountain View)</strong></td>
                        <td>$820.66</td>
                        <td>$395.20</td>
                        <td>$1,215.86</td>
                    </tr>
                    <tr>
                        <td><strong>Palazzo Standard (The Value Choice)</strong></td>
                        <td>$418.24</td>
                        <td>$395.20</td>
                        <td>$813.44</td>
                    </tr>
                    <tr>
                        <td><strong>Conrad Resorts World (The Tech Choice)</strong></td>
                        <td>$182.18</td>
                        <td>$395.20</td>
                        <td>$577.38</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Slide 4: Deep Dive - Palazzo Prestige -->
    <div class="slide-container" id="slide4">
        <div class="content-area">
            <h2 class="slide-title">Option A: Palazzo Prestige Suite</h2>
            <div class="two-column">
                <div>
                    <h3>The Exclusivity Advantage</h3>
                    <p style="margin-top: 15px;">A "hotel within a hotel." This category provides full insulation from the holiday weekend crowds with a private 23rd-floor sanctuary.</p>
                    <ul style="margin-top: 20px; list-style: none;">
                        <li style="margin-bottom: 12px;"><i class="fas fa-glass-cheers" style="color: var(--accent-green);"></i> <strong>Open Bar:</strong> Complimentary cocktails 4PM–7PM.</li>
                        <li style="margin-bottom: 12px;"><i class="fas fa-user-tie" style="color: var(--accent-green);"></i> <strong>Private Check-In:</strong> Skip the 45-min lobby lines.</li>
                        <li style="margin-bottom: 12px;"><i class="fas fa-clock" style="color: var(--accent-green);"></i> <strong>4PM Check-out:</strong> Guaranteed by Amex FHR.</li>
                    </ul>
                </div>
                <div class="image-wrapper" style="border-color: var(--accent-green);">
                    <img src="http://googleusercontent.com/image_collection/image_retrieval/17255707971604094942" alt="Palazzo Prestige Suite">
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 5: Deep Dive - The Cosmopolitan -->
    <div class="slide-container" id="slide5">
        <div class="content-area">
            <h2 class="slide-title">Option B: The Cosmopolitan</h2>
            <div class="two-column">
                <div class="image-wrapper" style="border-color: var(--accent-purple);">
                    <img src="http://googleusercontent.com/image_collection/image_retrieval/13430973132355381244" alt="Cosmopolitan Terrace View Night">
                </div>
                <div>
                    <h3>Terrace Studio Fountain View</h3>
                    <p style="margin-top: 15px;">The gold standard for romantic atmosphere. The only resort where we can listen to the Bellagio Fountains from our own private balcony.</p>
                    <div class="highlight-box">
                        <p><i class="fas fa-star" style="color: var(--gold);"></i> <strong>FHR Priority:</strong> $100 Food & Beverage credit and room upgrade potential.</p>
                        <p style="margin-top: 10px;"><i class="fas fa-map-marker-alt" style="color: var(--gold);"></i> <strong>Location:</strong> Center of the Strip, walkable to everything.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 8: Photo Gallery - Suites & Rooms -->
    <div class="slide-container" id="slide8">
        <div class="content-area">
            <h2 class="slide-title">Gallery: Accommodations</h2>
            <div class="gallery-grid">
                <div class="gallery-item">
                    <img src="http://googleusercontent.com/image_collection/image_retrieval/8130047276425911302" alt="Palazzo Suite Interior">
                    <div class="gallery-label">Palazzo Luxury King - 720 Sq. Ft.</div>
                </div>
                <div class="gallery-item">
                    <img src="http://googleusercontent.com/image_collection/image_retrieval/17390154220243293301" alt="Conrad Suite Style">
                    <div class="gallery-label">Conrad Strip View King</div>
                </div>
                <div class="gallery-item">
                    <img src="http://googleusercontent.com/image_collection/image_retrieval/3856754058026752445" alt="Cosmopolitan Terrace Detail">
                    <div class="gallery-label">Cosmopolitan Terrace Detail</div>
                </div>
                <div class="gallery-item" style="grid-column: span 3;">
                    <img src="http://googleusercontent.com/image_collection/image_retrieval/7710776312755100682" alt="Prestige Lounge">
                    <div class="gallery-label">Prestige Lounge Sanctuary (23rd Floor)</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 11: Final Comparison Summary -->
    <div class="slide-container" id="slide11">
        <div class="content-area">
            <h2 class="slide-title">The Verdict: Choosing the Experience</h2>
            <div class="comparison-grid">
                <div class="tile" style="background: var(--primary-purple); color: white; padding: 25px; border-radius: 8px;">
                    <h3 style="color: var(--gold);">The VIP Bubble</h3>
                    <p style="color: white; font-size: 14px; margin-top: 10px;">Choose <strong>Option A</strong> if you hate lines and want to enjoy a private open bar before dinner.</p>
                </div>
                <div class="tile" style="background: var(--forest-green); color: white; padding: 25px; border-radius: 8px;">
                    <h3 style="color: var(--gold);">The Romantic</h3>
                    <p style="color: white; font-size: 14px; margin-top: 10px;">Choose <strong>Option B</strong> if you want the ultimate fountain-view balcony experience.</p>
                </div>
                <div class="tile" style="background: var(--primary-purple); color: white; padding: 25px; border-radius: 8px;">
                    <h3 style="color: var(--gold);">The Smart Luxury</h3>
                    <p style="color: white; font-size: 14px; margin-top: 10px;">Choose <strong>Option C</strong> to save $400 for a massive shopping spree while still getting FHR perks.</p>
                </div>
                <div class="tile" style="background: var(--forest-green); color: white; padding: 25px; border-radius: 8px;">
                    <h3 style="color: var(--gold);">The Techie</h3>
                    <p style="color: white; font-size: 14px; margin-top: 10px;">Choose <strong>Option D</strong> for a brand-new resort for the price of a standard motel.</p>
                </div>
            </div>
            <p style="margin-top: 50px; text-align: center; font-size: 24px; color: var(--accent-green);"><strong>Ready to lock in the 4:50 PM Tuesday Flight?</strong></p>
        </div>
    </div>

    <!-- ✨ AI ASSISTANT INTERFACE ✨ -->
    <div id="ai-assistant-btn">
        <i class="fas fa-sparkles"></i>
    </div>

    <div id="ai-container">
        <div class="ai-header">
            <h4>✨ AI Trip Assistant</h4>
            <i class="fas fa-times" style="cursor: pointer;" id="close-ai"></i>
        </div>
        <div class="ai-messages" id="ai-messages">
            <div class="message bot-message">
                Hello! I'm your Vegas AI Assistant. I can help you compare these options or build a <b>Personalized Itinerary</b>. What's on your mind?
            </div>
        </div>
        <div class="ai-input-area">
            <div class="ai-suggestions">
                <div class="suggestion-chip" onclick="quickAsk('✨ Help me decide between Prestige and Cosmo')">✨ Help me decide</div>
                <div class="suggestion-chip" onclick="quickAsk('✨ Create a romantic itinerary for Palazzo Prestige')">✨ Create Itinerary</div>
                <div class="suggestion-chip" onclick="quickAsk('✨ What should I pack for mid-Feb in Vegas?')">✨ Packing Tips</div>
            </div>
            <div class="ai-input-row">
                <input type="text" id="ai-input" placeholder="Ask me about the trip...">
                <button class="ai-btn" id="ai-send-btn">Send</button>
            </div>
        </div>
    </div>

    <script>
        // --- Gemini API Logic ---
        const apiKey = ""; // Set by environment
        const model = "gemini-2.5-flash-preview-09-2025";
        
        const aiAssistantBtn = document.getElementById('ai-assistant-btn');
        const aiContainer = document.getElementById('ai-container');
        const closeAi = document.getElementById('close-ai');
        const aiMessages = document.getElementById('ai-messages');
        const aiInput = document.getElementById('ai-input');
        const aiSendBtn = document.getElementById('ai-send-btn');

        aiAssistantBtn.onclick = () => aiContainer.style.display = 'flex';
        closeAi.onclick = () => aiContainer.style.display = 'none';

        async function fetchAIResponse(userPrompt) {
            const systemPrompt = `You are a luxury travel assistant specializing in Las Vegas Valentine's Day trips. 
            You have the following data about the user's options:
            1. Palazzo Prestige: VIP lounge, 4pm checkout, open bar (4-7pm), $100 credit, breakfast. Price: $1,153.
            2. Cosmopolitan: Fountain view balcony, center strip, $100 F&B credit, breakfast, 4pm checkout. Price: $1,215.
            3. Palazzo Standard: Large suite, 4pm checkout, $100 credit, breakfast. Price: $813.
            4. Conrad: Tech-forward, $100 credit, no late checkout, no breakfast. Price: $577.
            
            Users are an Amex Platinum holder with a Southwest Companion Pass flying from STL. 
            They have a $100 Resy credit (COTE Vegas is recommended), $50 Saks, and $75 Lululemon credit.
            
            Keep responses helpful, romantic, and concise. Use bold text for key perks.`;

            let retries = 0;
            const maxRetries = 5;
            const backoff = (r) => Math.pow(2, r) * 1000;

            const callApi = async () => {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: userPrompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        tools: [{ "google_search": {} }] // Grounding for weather/search info
                    })
                });
                if (!response.ok) throw new Error('API Error');
                return response.json();
            };

            while (retries < maxRetries) {
                try {
                    return await callApi();
                } catch (e) {
                    retries++;
                    if (retries === maxRetries) throw e;
                    await new Promise(r => setTimeout(r, backoff(retries)));
                }
            }
        }

        async function handleSend() {
            const text = aiInput.value.trim();
            if (!text) return;

            addMessage(text, 'user-message');
            aiInput.value = '';
            aiSendBtn.disabled = true;

            const loadingId = addLoadingMessage();

            try {
                const data = await fetchAIResponse(text);
                const botResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I couldn't process that.";
                removeLoadingMessage(loadingId);
                addMessage(botResponse, 'bot-message');
            } catch (error) {
                removeLoadingMessage(loadingId);
                addMessage("I'm having trouble connecting to my servers. Please check your connection and try again.", 'bot-message');
            } finally {
                aiSendBtn.disabled = false;
            }
        }

        function addMessage(text, type) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${type}`;
            // Simple markdown-to-html (for bold and lists)
            let formattedText = text.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
            formattedText = formattedText.replace(/^\* (.*)/gm, '<li>$1</li>');
            if (formattedText.includes('<li>')) formattedText = '<ul>' + formattedText + '</ul>';
            
            msgDiv.innerHTML = formattedText;
            aiMessages.appendChild(msgDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;
        }

        function addLoadingMessage() {
            const id = 'loading-' + Date.now();
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message bot-message';
            msgDiv.id = id;
            msgDiv.innerHTML = '<div class="loading-dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>';
            aiMessages.appendChild(msgDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;
            return id;
        }

        function removeLoadingMessage(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        function quickAsk(text) {
            aiInput.value = text;
            handleSend();
        }

        aiSendBtn.onclick = handleSend;
        aiInput.onkeypress = (e) => { if (e.key === 'Enter') handleSend(); };

    </script>
</body>
</html>
